<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - Enterprise Architecture AI Assistant</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E‚ö°%3C/text%3E%3C/svg%3E">

    <!-- Modern CSS with glassmorphism and energy theme -->
    <style>
        :root {
            /* Claude.ai Inspired Colors */
            --primary-accent: #2563eb;
            --secondary-accent: #059669;
            --warning-amber: #f59e0b;
            --error-red: #dc2626;
            --success-green: #059669;

            /* Light Theme (Claude.ai style) */
            --light-bg-primary: #ffffff;
            --light-bg-secondary: #f8fafc;
            --light-bg-tertiary: #f1f5f9;
            --light-text-primary: #1e293b;
            --light-text-secondary: #64748b;
            --light-border: #e2e8f0;
            --light-hover: #f1f5f9;

            /* Dark Theme (Claude.ai style) */
            --dark-bg-primary: #0f172a;
            --dark-bg-secondary: #1e293b;
            --dark-bg-tertiary: #334155;
            --dark-text-primary: #f8fafc;
            --dark-text-secondary: #94a3b8;
            --dark-border: #334155;
            --dark-hover: #334155;

            /* Active colors based on theme */
            --bg-primary: var(--light-bg-primary);
            --bg-secondary: var(--light-bg-secondary);
            --bg-tertiary: var(--light-bg-tertiary);
            --text-primary: var(--light-text-primary);
            --text-secondary: var(--light-text-secondary);
            --border-color: var(--light-border);
            --hover-bg: var(--light-hover);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-secondary);
            min-height: 100vh;
            transition: all 0.3s ease;
            color: var(--text-primary);
        }

        body.dark {
            --bg-primary: var(--dark-bg-primary);
            --bg-secondary: var(--dark-bg-secondary);
            --bg-tertiary: var(--dark-bg-tertiary);
            --text-primary: var(--dark-text-primary);
            --text-secondary: var(--dark-text-secondary);
            --border-color: var(--dark-border);
            --hover-bg: var(--dark-hover);
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-primary);
            border-radius: 0;
            border: none;
            overflow: hidden;
            box-shadow: none;
        }

        /* Header */
        .header {
            background: var(--bg-primary);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header h1::before {
            content: "‚ö°";
            font-size: 1.8rem;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: var(--hover-bg);
            transform: none;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-green);
            animation: pulse 2s infinite;
        }

        .status-dot.offline {
            background: var(--error-red);
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Chat Container */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* Message Bubbles */
        .message {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            max-width: 80%;
            animation: messageIn 0.3s ease;
        }

        @keyframes messageIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message.assistant {
            align-self: flex-start;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .message.user .message-avatar {
            background: var(--primary-accent);
            color: white;
        }

        .message.assistant .message-avatar {
            background: var(--secondary-accent);
            color: white;
        }

        .message-content {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            color: var(--text-primary);
            position: relative;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: var(--primary-accent);
            color: white;
            border: 1px solid var(--primary-accent);
        }

        .message-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Confidence Indicator */
        .confidence-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--bg-secondary);
            padding: 0.25rem 0.75rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .confidence-bar {
            width: 60px;
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .confidence-fill.high {
            background: var(--success-green);
        }

        .confidence-fill.medium {
            background: var(--warning-amber);
        }

        .confidence-fill.low {
            background: var(--error-red);
        }

        /* Citations */
        .citations {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .citation-pill {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            color: var(--secondary-accent);
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Monaco', 'Consolas', monospace;
        }

        .citation-pill:hover {
            background: var(--secondary-accent);
            color: white;
            transform: none;
            box-shadow: none;
        }

        /* Human Review Banner */
        .review-banner {
            background: var(--warning-amber);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            margin-top: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }

        @keyframes reviewAlert {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .review-banner::before {
            content: "‚ö†Ô∏è";
            font-size: 1.2rem;
        }

        /* Message Actions */
        .message-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .action-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .action-btn:hover {
            background: var(--hover-bg);
            color: var(--text-primary);
            transform: none;
        }

        /* Input Area */
        .input-container {
            padding: 1rem 1.5rem;
            background: var(--bg-primary);
            border-top: 1px solid var(--border-color);
        }

        .input-wrapper {
            display: flex;
            gap: 1rem;
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            color: var(--text-primary);
            font-size: 1rem;
            resize: none;
            min-height: 50px;
            max-height: 120px;
            transition: border-color 0.2s ease;
        }

        .message-input:focus {
            outline: none;
            border-color: var(--primary-accent);
        }

        .message-input::placeholder {
            color: var(--text-secondary);
        }

        .send-btn {
            background: var(--primary-accent);
            border: none;
            border-radius: 12px;
            width: 50px;
            height: 50px;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .send-btn:hover:not(:disabled) {
            background: #1d4ed8;
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--light-text-secondary);
            font-style: italic;
            padding: 1rem;
        }

        .typing-dots {
            display: flex;
            gap: 0.25rem;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--accent-teal);
            animation: typingBounce 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typingBounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* Export Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            color: var(--text-primary);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .export-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .export-btn {
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-teal));
            color: white;
            border: none;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 102, 204, 0.3);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .app-container {
                border-radius: 0;
                height: 100vh;
            }

            .header {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.2rem;
            }

            .message {
                max-width: 95%;
            }

            .input-container {
                padding: 1rem;
            }

            .header-controls {
                flex-direction: column;
                gap: 0.5rem;
            }
        }

        /* Dark theme adjustments */
        body.dark .message-content {
            color: var(--dark-text-primary);
        }

        body.dark .message-input {
            color: var(--dark-text-primary);
        }

        body.dark .message-input::placeholder {
            color: var(--dark-text-secondary);
        }

        body.dark .header h1 {
            color: var(--dark-text-primary);
        }

        body.dark .status-indicator {
            color: var(--dark-text-secondary);
        }

        body.dark .modal-content {
            color: var(--dark-text-primary);
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <h1>{{ title }}</h1>
            <div class="header-controls">
                <div class="status-indicator">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="statusText">Connecting...</span>
                </div>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <span id="themeIcon">üåô</span>
                </button>
                <button class="action-btn" id="exportBtn" aria-label="Export conversation">
                    üìÑ Export
                </button>
            </div>
        </div>

        <!-- Chat Container -->
        <div class="chat-container">
            <div class="messages" id="messages">
                <!-- Welcome Message -->
                <div class="message assistant">
                    <div class="message-avatar">ü§ñ</div>
                    <div class="message-content">
                        <div>
                            üëã Welcome to the Alliander EA Assistant! I'm here to help you with enterprise architecture questions related to energy systems.
                        </div>
                        <div class="message-meta">
                            <div class="confidence-indicator">
                                <span>System</span>
                            </div>
                        </div>
                        <div class="citations">
                            <div class="citation-pill" title="System initialization">system:welcome</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Typing Indicator -->
            <div class="typing-indicator hidden" id="typingIndicator">
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
                <span>EA Assistant is thinking...</span>
            </div>

            <!-- Input Area -->
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea
                        class="message-input"
                        id="messageInput"
                        placeholder="Ask about energy architecture patterns, TOGAF phases, or ArchiMate elements..."
                        rows="1"
                    ></textarea>
                    <button class="send-btn" id="sendBtn" aria-label="Send message">
                        ‚û§
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Export Conversation</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="export-options">
                <button class="export-btn" onclick="exportConversation('markdown')">
                    üìù Export as Markdown
                </button>
                <button class="export-btn" onclick="exportConversation('json')">
                    üìä Export as JSON
                </button>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let currentTheme = 'light';
        let websocket = null;
        let sessionId = null;
        let isConnected = false;
        let messageHistory = [];

        // DOM Elements
        const messagesContainer = document.getElementById('messages');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const typingIndicator = document.getElementById('typingIndicator');
        const statusDot = document.getElementById('statusDot');
        const statusText = document.getElementById('statusText');
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const exportBtn = document.getElementById('exportBtn');
        const exportModal = document.getElementById('exportModal');
        const modalClose = document.getElementById('modalClose');

        // Initialize Application
        function init() {
            sessionId = generateSessionId();
            setupEventListeners();
            connectWebSocket();
            loadTheme();
        }

        function generateSessionId() {
            return 'session_' + Math.random().toString(36).substr(2, 9);
        }

        function setupEventListeners() {
            // Send message on button click
            sendBtn.addEventListener('click', sendMessage);

            // Send message on Enter (but allow Shift+Enter for new lines)
            messageInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Auto-resize textarea
            messageInput.addEventListener('input', (e) => {
                e.target.style.height = 'auto';
                e.target.style.height = e.target.scrollHeight + 'px';
            });

            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);

            // Export modal
            exportBtn.addEventListener('click', () => {
                exportModal.style.display = 'flex';
            });

            modalClose.addEventListener('click', () => {
                exportModal.style.display = 'none';
            });

            // Close modal on outside click
            exportModal.addEventListener('click', (e) => {
                if (e.target === exportModal) {
                    exportModal.style.display = 'none';
                }
            });
        }

        function connectWebSocket() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = `${protocol}//${window.location.host}/ws/${sessionId}`;

            websocket = new WebSocket(wsUrl);

            websocket.onopen = () => {
                isConnected = true;
                updateConnectionStatus(true);
            };

            websocket.onmessage = (event) => {
                const message = JSON.parse(event.data);
                handleIncomingMessage(message);
            };

            websocket.onclose = () => {
                isConnected = false;
                updateConnectionStatus(false);
                // Attempt to reconnect after 3 seconds
                setTimeout(connectWebSocket, 3000);
            };

            websocket.onerror = (error) => {
                console.error('WebSocket error:', error);
                updateConnectionStatus(false);
            };
        }

        function updateConnectionStatus(connected) {
            if (connected) {
                statusDot.classList.remove('offline');
                statusText.textContent = 'Connected';
                sendBtn.disabled = false;
            } else {
                statusDot.classList.add('offline');
                statusText.textContent = 'Disconnected';
                sendBtn.disabled = true;
            }
        }

        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message || !isConnected) return;

            // Add user message to UI
            addMessage({
                type: 'user',
                content: message,
                timestamp: new Date().toISOString()
            });

            // Send to server
            websocket.send(JSON.stringify({
                message: message,
                session_id: sessionId
            }));

            // Clear input
            messageInput.value = '';
            messageInput.style.height = 'auto';

            // Show typing indicator
            showTypingIndicator();
        }

        function handleIncomingMessage(message) {
            hideTypingIndicator();

            if (message.type === 'typing') {
                showTypingIndicator(message.content);
                return;
            }

            addMessage(message);
        }

        function addMessage(message) {
            messageHistory.push(message);

            const messageElement = createMessageElement(message);
            messagesContainer.appendChild(messageElement);

            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function createMessageElement(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${message.type}`;

            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = message.type === 'user' ? 'üë§' : 'ü§ñ';

            const content = document.createElement('div');
            content.className = 'message-content';

            const messageText = document.createElement('div');
            messageText.textContent = message.content;
            content.appendChild(messageText);

            // Add metadata for assistant messages
            if (message.type === 'assistant' || message.type === 'error') {
                const meta = createMessageMeta(message);
                content.appendChild(meta);
            }

            // Add citations if present
            if (message.citations && message.citations.length > 0) {
                const citations = createCitations(message.citations);
                content.appendChild(citations);
            }

            // Add human review banner if needed
            if (message.requires_human_review) {
                const banner = createReviewBanner();
                content.appendChild(banner);
            }

            // Add message actions
            const actions = createMessageActions(message);
            content.appendChild(actions);

            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);

            return messageDiv;
        }

        function createMessageMeta(message) {
            const meta = document.createElement('div');
            meta.className = 'message-meta';

            if (message.confidence !== undefined) {
                const confidenceIndicator = createConfidenceIndicator(message.confidence);
                meta.appendChild(confidenceIndicator);
            }

            const timestamp = document.createElement('span');
            timestamp.textContent = new Date(message.timestamp).toLocaleTimeString();
            meta.appendChild(timestamp);

            return meta;
        }

        function createConfidenceIndicator(confidence) {
            const indicator = document.createElement('div');
            indicator.className = 'confidence-indicator';

            const label = document.createElement('span');
            label.textContent = `${Math.round(confidence * 100)}%`;

            const bar = document.createElement('div');
            bar.className = 'confidence-bar';

            const fill = document.createElement('div');
            fill.className = 'confidence-fill';
            fill.style.width = `${confidence * 100}%`;

            if (confidence >= 0.75) {
                fill.classList.add('high');
            } else if (confidence >= 0.5) {
                fill.classList.add('medium');
            } else {
                fill.classList.add('low');
            }

            bar.appendChild(fill);
            indicator.appendChild(label);
            indicator.appendChild(bar);

            return indicator;
        }

        function createCitations(citations) {
            const container = document.createElement('div');
            container.className = 'citations';

            citations.forEach(citation => {
                const pill = document.createElement('div');
                pill.className = 'citation-pill';
                pill.textContent = citation;
                pill.title = `Source: ${citation}`;

                pill.addEventListener('click', () => {
                    navigator.clipboard.writeText(citation);
                    showToast('Citation copied to clipboard!');
                });

                container.appendChild(pill);
            });

            return container;
        }

        function createReviewBanner() {
            const banner = document.createElement('div');
            banner.className = 'review-banner';
            banner.textContent = 'Human Review Required - Low Confidence Response';
            return banner;
        }

        function createMessageActions(message) {
            const actions = document.createElement('div');
            actions.className = 'message-actions';

            const copyBtn = document.createElement('button');
            copyBtn.className = 'action-btn';
            copyBtn.textContent = 'üìã Copy';
            copyBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(message.content);
                showToast('Message copied to clipboard!');
            });

            actions.appendChild(copyBtn);
            return actions;
        }

        function showTypingIndicator(text) {
            if (text) {
                typingIndicator.querySelector('span').textContent = text;
            }
            typingIndicator.classList.remove('hidden');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            typingIndicator.classList.add('hidden');
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.className = currentTheme === 'dark' ? 'dark' : '';
            themeIcon.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            localStorage.setItem('theme', currentTheme);
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            currentTheme = savedTheme;
            document.body.className = currentTheme === 'dark' ? 'dark' : '';
            themeIcon.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        async function exportConversation(format) {
            try {
                const response = await fetch(`/api/export/${sessionId}?format=${format}`, {
                    method: 'POST'
                });

                if (response.ok) {
                    const data = await response.json();
                    downloadFile(data.content, data.filename, format === 'json' ? 'application/json' : 'text/markdown');
                    exportModal.style.display = 'none';
                    showToast('Conversation exported successfully!');
                } else {
                    showToast('Export failed. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Export error:', error);
                showToast('Export failed. Please try again.', 'error');
            }
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function showToast(message, type = 'success') {
            // Simple toast implementation
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? 'var(--error-red)' : 'var(--success-green)'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            toast.textContent = message;

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Initialize the application
        init();

        // Sample queries for testing
        window.testQueries = [
            "What capability should I use for grid congestion management?",
            "How do I model SCADA systems in ArchiMate?",
            "What TOGAF phase covers business architecture?",
            "Show me IEC standards for power measurement"
        ];

        // Add sample query buttons for demo
        function addSampleQueries() {
            const sampleContainer = document.createElement('div');
            sampleContainer.style.cssText = `
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                margin: 1rem;
                padding: 1rem;
                background: var(--glass-bg);
                border-radius: 12px;
                border: 1px solid var(--glass-border);
            `;

            const title = document.createElement('div');
            title.textContent = 'Try these sample queries:';
            title.style.cssText = `
                width: 100%;
                color: var(--light-text-secondary);
                font-size: 0.9rem;
                margin-bottom: 0.5rem;
            `;
            sampleContainer.appendChild(title);

            window.testQueries.forEach(query => {
                const btn = document.createElement('button');
                btn.textContent = query;
                btn.style.cssText = `
                    background: var(--glass-bg);
                    border: 1px solid var(--glass-border);
                    border-radius: 20px;
                    padding: 0.5rem 1rem;
                    color: var(--light-text-primary);
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-size: 0.8rem;
                `;

                btn.addEventListener('click', () => {
                    messageInput.value = query;
                    sendMessage();
                    sampleContainer.style.display = 'none';
                });

                btn.addEventListener('mouseenter', () => {
                    btn.style.background = 'rgba(255, 255, 255, 0.2)';
                    btn.style.transform = 'translateY(-2px)';
                });

                btn.addEventListener('mouseleave', () => {
                    btn.style.background = 'var(--glass-bg)';
                    btn.style.transform = 'translateY(0)';
                });

                sampleContainer.appendChild(btn);
            });

            messagesContainer.appendChild(sampleContainer);
        }

        // Add sample queries after initial load
        setTimeout(addSampleQueries, 1000);
    </script>
</body>
</html>