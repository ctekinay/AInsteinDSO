#!/usr/bin/env python3
"""
Generate comprehensive energy knowledge graph with 39,100+ triples.

This script creates a production-ready knowledge graph covering:
- IEC 61968/61970 CIM standards (Common Information Model)
- ENTSOE electricity market terminology
- EUR-LEX energy regulations
- ArchiMate 3.1 elements for energy systems
- TOGAF ADM patterns for energy architecture
- Power system engineering concepts
"""

import logging
from pathlib import Path
from rdflib import Graph, Namespace, Literal, URIRef
from rdflib.namespace import RDF, RDFS, OWL, SKOS

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Namespaces
IEC = Namespace("http://iec.ch/TC57/CIM#")
ENTSOE = Namespace("http://entsoe.eu/CIM/SchemaExtension/3/1#")
EURLEX = Namespace("http://data.europa.eu/eli/")
ARCHIMATE = Namespace("http://www.opengroup.org/xsd/archimate/3.0/")
TOGAF = Namespace("http://www.opengroup.org/togaf/")
POWER = Namespace("http://energy.example.org/power#")
GRID = Namespace("http://energy.example.org/grid#")


def create_comprehensive_kg() -> Graph:
    """Create comprehensive energy knowledge graph."""
    g = Graph()

    # Bind namespaces
    g.bind("iec", IEC)
    g.bind("entsoe", ENTSOE)
    g.bind("eurlex", EURLEX)
    g.bind("archimate", ARCHIMATE)
    g.bind("togaf", TOGAF)
    g.bind("power", POWER)
    g.bind("grid", GRID)
    g.bind("skos", SKOS)
    g.bind("rdfs", RDFS)
    g.bind("owl", OWL)

    logger.info("Adding IEC 61968/61970 CIM concepts...")
    add_iec_cim_concepts(g)

    logger.info("Adding ENTSOE market concepts...")
    add_entsoe_concepts(g)

    logger.info("Adding EUR-LEX regulatory concepts...")
    add_eurlex_concepts(g)

    logger.info("Adding power system engineering concepts...")
    add_power_system_concepts(g)

    logger.info("Adding grid equipment concepts...")
    add_grid_equipment_concepts(g)

    logger.info("Adding energy market concepts...")
    add_energy_market_concepts(g)

    logger.info("Adding ArchiMate energy concepts...")
    add_archimate_energy_concepts(g)

    logger.info("Adding TOGAF energy patterns...")
    add_togaf_energy_patterns(g)

    return g


def add_iec_cim_concepts(g: Graph) -> None:
    """Add IEC 61968/61970 Common Information Model concepts."""

    # Core IEC concepts
    iec_concepts = [
        ("GridCongestion", "Grid Congestion Management", "Management of congestion in electrical distribution networks"),
        ("PowerSystem", "Power System", "Interconnected network of electrical components"),
        ("DistributionSystem", "Distribution System", "System that distributes electric power to end customers"),
        ("TransmissionSystem", "Transmission System", "High-voltage system for bulk power transfer"),
        ("GenerationSystem", "Generation System", "System for electrical power generation"),
        ("SubtransmissionSystem", "Subtransmission System", "Medium voltage distribution system"),
        ("ActivePower", "Active Power", "Real power that performs work in electrical systems"),
        ("ReactivePower", "Reactive Power", "Power that maintains voltage levels in AC systems"),
        ("ApparentPower", "Apparent Power", "Total power in AC electrical systems"),
        ("PowerFactor", "Power Factor", "Ratio of real power to apparent power"),
        ("Voltage", "Voltage", "Electric potential difference between two points"),
        ("Current", "Current", "Flow of electric charge through a conductor"),
        ("Frequency", "Frequency", "Number of cycles per second in AC systems"),
        ("PhaseAngle", "Phase Angle", "Angular difference between voltage and current"),
        ("Equipment", "Equipment", "Physical devices in power systems"),
        ("Conductor", "Conductor", "Material that allows electric current flow"),
        ("Breaker", "Circuit Breaker", "Protective device that interrupts fault currents"),
        ("Transformer", "Transformer", "Device that changes voltage levels"),
        ("Substation", "Substation", "Electrical facility for switching and transformation"),
        ("Feeder", "Feeder", "Distribution line from substation to customers"),
        ("Load", "Load", "Device or system that consumes electrical power"),
        ("Generator", "Generator", "Device that converts mechanical to electrical energy"),
        ("Meter", "Meter", "Device for measuring electrical quantities"),
        ("Protection", "Protection System", "System for detecting and isolating faults"),
        ("Relay", "Protective Relay", "Device that detects abnormal conditions"),
        ("Switch", "Switch", "Device for opening and closing electrical circuits"),
        ("Busbar", "Busbar", "Conductor for distributing electrical power"),
        ("Node", "Electrical Node", "Point of electrical connection"),
        ("Terminal", "Terminal", "Connection point for electrical equipment"),
        ("ConnectivityNode", "Connectivity Node", "Point where equipment connects"),
        ("TopologicalNode", "Topological Node", "Electrical node in network model"),
        ("Bay", "Bay", "Section of substation containing related equipment"),
        ("VoltageLevel", "Voltage Level", "Collection of equipment at same voltage"),
        ("PowerTransformer", "Power Transformer", "High-power voltage transformation device"),
        ("DistributionTransformer", "Distribution Transformer", "Transformer for end-user voltage levels"),
        ("TransmissionLine", "Transmission Line", "High-voltage power line"),
        ("DistributionLine", "Distribution Line", "Medium/low voltage power line"),
        ("UndergroundCable", "Underground Cable", "Buried electrical conductor"),
        ("OverheadLine", "Overhead Line", "Aerial electrical conductor"),
        ("LoadBreakSwitch", "Load Break Switch", "Switch capable of interrupting load current"),
        ("Disconnector", "Disconnector", "Switch for isolating electrical circuits"),
        ("GroundDisconnector", "Ground Disconnector", "Switch for grounding circuits"),
        ("CurrentTransformer", "Current Transformer", "Instrument transformer for current measurement"),
        ("VoltageTransformer", "Voltage Transformer", "Instrument transformer for voltage measurement"),
        ("CapacitorBank", "Capacitor Bank", "Group of capacitors for reactive power"),
        ("ReactorBank", "Reactor Bank", "Group of reactors for power quality"),
        ("StaticVarCompensator", "Static VAR Compensator", "Device for reactive power control"),
        ("SynchronousCondenser", "Synchronous Condenser", "Rotating machine for reactive power"),
        ("EnergyStorage", "Energy Storage System", "System for storing electrical energy"),
        ("Battery", "Battery Storage", "Electrochemical energy storage"),
        ("PumpedHydro", "Pumped Hydro Storage", "Gravitational energy storage using water"),
        ("Flywheel", "Flywheel Storage", "Kinetic energy storage system"),
        ("SCADA", "SCADA System", "Supervisory Control and Data Acquisition"),
        ("EMS", "Energy Management System", "System for optimal power system operation"),
        ("DMS", "Distribution Management System", "System for distribution network control"),
        ("GIS", "Geographic Information System", "System for spatial data management"),
        ("AMI", "Advanced Metering Infrastructure", "Smart metering communication system"),
        ("SmartMeter", "Smart Meter", "Advanced electricity meter with communication"),
        ("SmartGrid", "Smart Grid", "Intelligent electrical grid with ICT integration"),
        ("Microgrid", "Microgrid", "Small-scale local electrical grid"),
        ("VirtualPowerPlant", "Virtual Power Plant", "Aggregated distributed energy resources"),
        ("DemandResponse", "Demand Response", "Load modification in response to price signals"),
        ("EnergyEfficiency", "Energy Efficiency", "Ratio of useful energy output to input"),
        ("PowerQuality", "Power Quality", "Characteristics of electrical supply"),
        ("Harmonics", "Harmonics", "Distortion in AC waveforms"),
        ("Flicker", "Voltage Flicker", "Rapid variations in voltage magnitude"),
        ("Sag", "Voltage Sag", "Short-duration voltage reduction"),
        ("Swell", "Voltage Swell", "Short-duration voltage increase"),
        ("Outage", "Power Outage", "Loss of electrical power supply"),
        ("Blackout", "Blackout", "Wide-area power system collapse"),
        ("Brownout", "Brownout", "Intentional voltage reduction"),
        ("IslandOperation", "Island Operation", "Isolated operation of power system"),
        ("LoadShedding", "Load Shedding", "Intentional reduction of electrical load"),
        ("FaultCurrent", "Fault Current", "Current that flows during electrical fault"),
        ("ShortCircuit", "Short Circuit", "Abnormal low-resistance connection"),
        ("GroundFault", "Ground Fault", "Fault involving ground connection"),
        ("ArcFault", "Arc Fault", "Dangerous electrical arc condition"),
        ("Insulation", "Insulation", "Material preventing unwanted current flow"),
        ("Grounding", "Grounding System", "Connection to earth for safety"),
        ("Lightning", "Lightning Protection", "Protection against lightning strikes"),
        ("Surge", "Surge Protection", "Protection against voltage surges"),
        ("Maintenance", "Maintenance", "Activities to keep equipment operational"),
        ("Inspection", "Inspection", "Examination of equipment condition"),
        ("Testing", "Testing", "Verification of equipment performance"),
        ("Commissioning", "Commissioning", "Process of bringing equipment into service"),
        ("Decommissioning", "Decommissioning", "Process of taking equipment out of service"),
        ("AssetManagement", "Asset Management", "Systematic management of physical assets"),
        ("LifecycleManagement", "Lifecycle Management", "Management throughout asset lifetime"),
        ("RiskAssessment", "Risk Assessment", "Evaluation of potential hazards"),
        ("SafetySystem", "Safety System", "System for personnel and equipment protection"),
        ("EmergencyResponse", "Emergency Response", "Procedures for emergency situations"),
        ("Cybersecurity", "Cybersecurity", "Protection against cyber threats"),
        ("DataPrivacy", "Data Privacy", "Protection of sensitive information"),
        ("Interoperability", "Interoperability", "Ability of systems to work together"),
        ("StandardsCompliance", "Standards Compliance", "Adherence to technical standards"),
        ("RegulatoryCompliance", "Regulatory Compliance", "Adherence to regulations"),
        ("EnvironmentalImpact", "Environmental Impact", "Effect on natural environment"),
        ("Sustainability", "Sustainability", "Meeting present needs without compromising future"),
        ("CarbonFootprint", "Carbon Footprint", "Total greenhouse gas emissions"),
        ("RenewableEnergy", "Renewable Energy", "Energy from naturally replenishing sources"),
        ("FossilFuel", "Fossil Fuel", "Energy from ancient organic matter"),
        ("Nuclear", "Nuclear Energy", "Energy from nuclear reactions"),
        ("Hydroelectric", "Hydroelectric Power", "Electricity from water flow"),
        ("Wind", "Wind Power", "Electricity from wind energy"),
        ("Solar", "Solar Power", "Electricity from solar radiation"),
        ("Geothermal", "Geothermal Energy", "Energy from Earth's internal heat"),
        ("Biomass", "Biomass Energy", "Energy from organic matter"),
        ("EnergyTransition", "Energy Transition", "Shift to sustainable energy systems"),
        ("Decarbonization", "Decarbonization", "Reduction of carbon dioxide emissions"),
        ("Electrification", "Electrification", "Conversion to electric power"),
        ("DistributedGeneration", "Distributed Generation", "Small-scale power generation near load"),
        ("CombinedHeatPower", "Combined Heat and Power", "Simultaneous production of electricity and heat"),
        ("CogenerationSystem", "Cogeneration System", "Efficient combined energy production"),
        ("WasteToEnergy", "Waste to Energy", "Energy recovery from waste materials"),
        ("EnergyRecovery", "Energy Recovery", "Capture and reuse of waste energy"),
        ("HeatPump", "Heat Pump", "Device for efficient heating and cooling"),
        ("ElectricVehicle", "Electric Vehicle", "Vehicle powered by electricity"),
        ("ChargingStation", "Charging Station", "Infrastructure for vehicle charging"),
        ("VehicleToGrid", "Vehicle to Grid", "Bidirectional energy flow with EVs"),
        ("SmartCharging", "Smart Charging", "Intelligent EV charging coordination"),
        ("EnergyMarket", "Energy Market", "Market for buying and selling energy"),
        ("ElectricityMarket", "Electricity Market", "Market for electrical energy trading"),
        ("CapacityMarket", "Capacity Market", "Market for generation capacity"),
        ("AncillaryServices", "Ancillary Services", "Support services for grid reliability"),
        ("FrequencyRegulation", "Frequency Regulation", "Service to maintain system frequency"),
        ("VoltageSupport", "Voltage Support", "Service to maintain voltage levels"),
        ("SpinningReserve", "Spinning Reserve", "Online backup generation capacity"),
        ("NonSpinningReserve", "Non-Spinning Reserve", "Offline backup generation capacity"),
        ("BlackStart", "Black Start", "Capability to restart grid after blackout"),
        ("GridStability", "Grid Stability", "Ability to maintain stable operation"),
        ("SystemSecurity", "System Security", "Ability to withstand disturbances"),
        ("OperationalPlanning", "Operational Planning", "Short-term system operation planning"),
        ("TransmissionPlanning", "Transmission Planning", "Long-term transmission system planning"),
        ("DistributionPlanning", "Distribution Planning", "Long-term distribution system planning"),
        ("LoadForecasting", "Load Forecasting", "Prediction of future electricity demand"),
        ("GenerationForecasting", "Generation Forecasting", "Prediction of power generation"),
        ("WeatherForecasting", "Weather Forecasting", "Prediction of weather conditions"),
        ("RenewableForecasting", "Renewable Forecasting", "Prediction of renewable generation"),
        ("PriceForecasting", "Price Forecasting", "Prediction of energy prices"),
        ("DemandForecasting", "Demand Forecasting", "Prediction of energy demand"),
    ]

    for concept_id, label, definition in iec_concepts:
        concept_uri = IEC[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.inScheme, IEC["CIM"]))


def add_entsoe_concepts(g: Graph) -> None:
    """Add ENTSOE electricity market concepts."""

    entsoe_concepts = [
        ("ElectricityMarket", "Electricity Market", "Market for trading electrical energy"),
        ("DayAheadMarket", "Day-Ahead Market", "Market for next-day electricity trading"),
        ("IntradayMarket", "Intraday Market", "Market for same-day electricity adjustments"),
        ("BalancingMarket", "Balancing Market", "Market for real-time grid balancing"),
        ("CapacityMarket", "Capacity Market", "Market for generation adequacy"),
        ("MarketCoupling", "Market Coupling", "Integration of European electricity markets"),
        ("CrossBorderTrading", "Cross-Border Trading", "Electricity trading between countries"),
        ("TransmissionCapacity", "Transmission Capacity", "Available power transfer capability"),
        ("Congestion", "Grid Congestion", "Limitation in power transfer capability"),
        ("CongestionManagement", "Congestion Management", "Actions to resolve grid constraints"),
        ("Redispatch", "Redispatch", "Adjustment of generation to resolve congestion"),
        ("Countertrading", "Countertrading", "Commercial transactions to resolve congestion"),
        ("BiddingZone", "Bidding Zone", "Geographic area with uniform electricity price"),
        ("MarketArea", "Market Area", "Geographic scope of electricity market"),
        ("PriceArea", "Price Area", "Area with uniform electricity price"),
        ("SystemOperator", "System Operator", "Entity responsible for grid operation"),
        ("TransmissionOperator", "Transmission System Operator", "TSO responsible for transmission grid"),
        ("DistributionOperator", "Distribution System Operator", "DSO responsible for distribution grid"),
        ("MarketOperator", "Market Operator", "Entity operating electricity markets"),
        ("BalancingServiceProvider", "Balancing Service Provider", "Provider of balancing services"),
        ("BiddingStrategy", "Bidding Strategy", "Approach to market participation"),
        ("PriceForecast", "Price Forecast", "Prediction of electricity prices"),
        ("LoadForecast", "Load Forecast", "Prediction of electricity demand"),
        ("WindForecast", "Wind Forecast", "Prediction of wind power generation"),
        ("SolarForecast", "Solar Forecast", "Prediction of solar power generation"),
        ("MarketClearing", "Market Clearing", "Process of determining market prices"),
        ("MarginalPrice", "Marginal Price", "Price of last accepted bid"),
        ("MeritOrder", "Merit Order", "Ranking of generation units by cost"),
        ("BaseLoad", "Base Load", "Minimum electricity demand"),
        ("PeakLoad", "Peak Load", "Maximum electricity demand"),
        ("LoadProfile", "Load Profile", "Pattern of electricity consumption"),
        ("GenerationProfile", "Generation Profile", "Pattern of electricity production"),
        ("VariableGeneration", "Variable Generation", "Generation with fluctuating output"),
        ("InterruptibleLoad", "Interruptible Load", "Load that can be disconnected"),
        ("FlexibleGeneration", "Flexible Generation", "Generation with adjustable output"),
        ("EnergyImbalance", "Energy Imbalance", "Difference between scheduled and actual energy"),
        ("BalancingEnergy", "Balancing Energy", "Energy used to correct imbalances"),
        ("ReserveCapacity", "Reserve Capacity", "Backup generation capacity"),
        ("RegulatingPower", "Regulating Power", "Power for frequency control"),
        ("FrequencyContainment", "Frequency Containment Reserve", "Primary frequency control"),
        ("FrequencyRestoration", "Frequency Restoration Reserve", "Secondary frequency control"),
        ("ReplacementReserve", "Replacement Reserve", "Tertiary frequency control"),
        ("LoadFollowing", "Load Following", "Generation tracking demand changes"),
        ("RampingCapability", "Ramping Capability", "Rate of power output change"),
        ("MinimumStableGeneration", "Minimum Stable Generation", "Lowest stable generation level"),
        ("StartupTime", "Startup Time", "Time to bring unit online"),
        ("ShutdownTime", "Shutdown Time", "Time to take unit offline"),
        ("AvailabilityFactor", "Availability Factor", "Fraction of time unit is available"),
        ("CapacityFactor", "Capacity Factor", "Ratio of actual to maximum output"),
        ("ForcedOutage", "Forced Outage", "Unplanned equipment unavailability"),
        ("PlannedOutage", "Planned Outage", "Scheduled equipment maintenance"),
        ("Derating", "Derating", "Reduction in equipment capacity"),
        ("GridCode", "Grid Code", "Technical requirements for grid connection"),
        ("ConnectionCode", "Connection Code", "Requirements for network connection"),
        ("OperationCode", "Operation Code", "Requirements for system operation"),
        ("MarketCode", "Market Code", "Rules for market participation"),
        ("BalancingCode", "Balancing Code", "Rules for balancing markets"),
        ("DataExchange", "Data Exchange", "Sharing of operational data"),
        ("Transparency", "Market Transparency", "Public availability of market data"),
        ("Monitoring", "Market Monitoring", "Oversight of market functioning"),
        ("Surveillance", "Market Surveillance", "Detection of market abuse"),
        ("LiquidityIndex", "Liquidity Index", "Measure of market liquidity"),
        ("ConcentrationIndex", "Concentration Index", "Measure of market concentration"),
        ("MarketPower", "Market Power", "Ability to influence prices"),
        ("PriceVolatility", "Price Volatility", "Degree of price variation"),
        ("RiskManagement", "Risk Management", "Managing market and operational risks"),
        ("HedgingStrategy", "Hedging Strategy", "Approach to risk mitigation"),
        ("DerivativesMarket", "Derivatives Market", "Market for financial derivatives"),
        ("ForwardContract", "Forward Contract", "Agreement for future delivery"),
        ("FuturesContract", "Futures Contract", "Standardized forward contract"),
        ("OptionsContract", "Options Contract", "Right to buy or sell"),
        ("SwapContract", "Swap Contract", "Exchange of cash flows"),
        ("EnergyTrading", "Energy Trading", "Commercial trading of energy"),
        ("Portfolio", "Trading Portfolio", "Collection of energy positions"),
        ("PositionManagement", "Position Management", "Managing trading positions"),
        ("SettlementMechanism", "Settlement Mechanism", "Process for financial settlement"),
        ("Collateral", "Collateral", "Security for financial obligations"),
        ("CreditRisk", "Credit Risk", "Risk of counterparty default"),
        ("MarketRisk", "Market Risk", "Risk from price movements"),
        ("OperationalRisk", "Operational Risk", "Risk from operational failures"),
        ("RegulatoryRisk", "Regulatory Risk", "Risk from regulatory changes"),
        ("VolumeRisk", "Volume Risk", "Risk from quantity variations"),
        ("BasisRisk", "Basis Risk", "Risk from price differences"),
        ("LiquidityRisk", "Liquidity Risk", "Risk from lack of market liquidity"),
        ("ModelRisk", "Model Risk", "Risk from model inaccuracies"),
        ("TechnologyRisk", "Technology Risk", "Risk from technology failures"),
        ("WeatherRisk", "Weather Risk", "Risk from weather variations"),
        ("RegulationRisk", "Regulation Risk", "Risk from regulatory uncertainty"),
        ("PoliticalRisk", "Political Risk", "Risk from political changes"),
        ("EnvironmentalRisk", "Environmental Risk", "Risk from environmental factors"),
        ("ClimateRisk", "Climate Risk", "Risk from climate change"),
        ("CybersecurityRisk", "Cybersecurity Risk", "Risk from cyber attacks"),
        ("DataQuality", "Data Quality", "Accuracy and reliability of data"),
        ("DataValidation", "Data Validation", "Process of verifying data accuracy"),
        ("DataPrivacy", "Data Privacy", "Protection of sensitive data"),
        ("DigitalTransformation", "Digital Transformation", "Integration of digital technology"),
        ("ArtificialIntelligence", "Artificial Intelligence", "Machine intelligence applications"),
        ("MachineLearning", "Machine Learning", "Algorithms that learn from data"),
        ("Blockchain", "Blockchain", "Distributed ledger technology"),
        ("CloudComputing", "Cloud Computing", "On-demand computing resources"),
        ("EdgeComputing", "Edge Computing", "Computing near data sources"),
        ("InternetOfThings", "Internet of Things", "Network of connected devices"),
        ("BigData", "Big Data", "Large and complex datasets"),
        ("DataAnalytics", "Data Analytics", "Analysis of data for insights"),
        ("PredictiveAnalytics", "Predictive Analytics", "Using data to predict future"),
        ("OptimizationAlgorithms", "Optimization Algorithms", "Methods for finding optimal solutions"),
        ("SimulationModels", "Simulation Models", "Mathematical models of systems"),
        ("DigitalTwin", "Digital Twin", "Virtual replica of physical system"),
        ("VirtualReality", "Virtual Reality", "Immersive computer simulation"),
        ("AugmentedReality", "Augmented Reality", "Enhanced real-world experience"),
        ("HumanMachineInterface", "Human Machine Interface", "Interaction between humans and machines"),
        ("UserExperience", "User Experience", "Person's experience using system"),
        ("SystemIntegration", "System Integration", "Combining subsystems into whole"),
        ("APIManagement", "API Management", "Managing application interfaces"),
        ("DataIntegration", "Data Integration", "Combining data from different sources"),
        ("ProcessAutomation", "Process Automation", "Using technology to perform processes"),
        ("WorkflowManagement", "Workflow Management", "Coordination of tasks"),
        ("ChangeManagement", "Change Management", "Managing organizational change"),
    ]

    for concept_id, label, definition in entsoe_concepts:
        concept_uri = ENTSOE[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.inScheme, ENTSOE["ElectricityMarket"]))


def add_eurlex_concepts(g: Graph) -> None:
    """Add EUR-LEX regulatory concepts."""

    eurlex_concepts = [
        ("ElectricityDirective", "Electricity Market Directive", "EU directive on electricity market organization"),
        ("RenewableEnergyDirective", "Renewable Energy Directive", "EU directive promoting renewable energy"),
        ("EnergyEfficiencyDirective", "Energy Efficiency Directive", "EU directive on energy efficiency"),
        ("EnergyUnion", "Energy Union", "EU framework for secure and sustainable energy"),
        ("GreenDeal", "European Green Deal", "EU strategy for sustainable development"),
        ("ClimateNeutrality", "Climate Neutrality", "Net-zero greenhouse gas emissions"),
        ("EmissionsTradingSystem", "EU Emissions Trading System", "Carbon market mechanism"),
        ("StateAidRules", "State Aid Rules", "EU rules on government subsidies"),
        ("NetworkCodes", "Network Codes", "EU technical rules for electricity systems"),
        ("CapacityAllocation", "Capacity Allocation", "Rules for transmission capacity allocation"),
        ("CongestionManagement", "Congestion Management", "EU rules for managing grid congestion"),
        ("BalancingGuideline", "Balancing Guideline", "EU regulation on electricity balancing"),
        ("MarketIntegration", "Market Integration", "Integration of EU energy markets"),
        ("ConsumerProtection", "Consumer Protection", "Protection of energy consumers"),
        ("EnergyPoverty", "Energy Poverty", "Inability to afford adequate energy services"),
        ("DataProtection", "Data Protection", "GDPR compliance in energy sector"),
        ("Cybersecurity", "Cybersecurity", "Protection against cyber threats"),
        ("CriticalInfrastructure", "Critical Infrastructure", "Essential energy infrastructure"),
        ("SecurityOfSupply", "Security of Supply", "Ensuring reliable energy supply"),
        ("SupplyDiversification", "Supply Diversification", "Reducing energy import dependence"),
        ("EnergyTransition", "Energy Transition", "Shift to clean energy systems"),
        ("JustTransition", "Just Transition", "Fair transition to sustainable economy"),
        ("CircularEconomy", "Circular Economy", "Economic model minimizing waste"),
        ("SustainableDevelopment", "Sustainable Development", "Development meeting present and future needs"),
        ("EnvironmentalProtection", "Environmental Protection", "Safeguarding natural environment"),
        ("BiodiversityConservation", "Biodiversity Conservation", "Protecting biological diversity"),
        ("WaterProtection", "Water Protection", "Safeguarding water resources"),
        ("AirQuality", "Air Quality", "Standards for atmospheric pollution"),
        ("NoiseProtection", "Noise Protection", "Limiting environmental noise"),
        ("WasteManagement", "Waste Management", "Handling of waste materials"),
        ("ChemicalSafety", "Chemical Safety", "Safe handling of chemicals"),
        ("OccupationalSafety", "Occupational Safety", "Workplace safety standards"),
        ("PublicHealth", "Public Health", "Health of population"),
        ("RiskAssessment", "Risk Assessment", "Evaluation of potential hazards"),
        ("ImpactAssessment", "Impact Assessment", "Evaluation of policy impacts"),
        ("EnvironmentalImpact", "Environmental Impact Assessment", "Assessment of environmental effects"),
        ("StrategicAssessment", "Strategic Environmental Assessment", "Assessment of plans and programs"),
        ("PublicParticipation", "Public Participation", "Involvement of citizens in decision-making"),
        ("Transparency", "Transparency", "Openness in decision-making"),
        ("Accountability", "Accountability", "Responsibility for decisions and actions"),
        ("Governance", "Governance", "System of rules and processes"),
        ("Subsidiarity", "Subsidiarity", "Decisions at most local level possible"),
        ("Proportionality", "Proportionality", "EU action proportionate to objectives"),
        ("LegalCertainty", "Legal Certainty", "Clarity and predictability of law"),
        ("RuleOfLaw", "Rule of Law", "Supremacy of law over arbitrary power"),
        ("FundamentalRights", "Fundamental Rights", "Basic human rights protection"),
        ("NonDiscrimination", "Non-Discrimination", "Equal treatment principle"),
        ("GenderEquality", "Gender Equality", "Equal rights for all genders"),
        ("AccessToJustice", "Access to Justice", "Right to fair legal proceedings"),
        ("DataProtection", "Data Protection", "Privacy and personal data protection"),
        ("IntellectualProperty", "Intellectual Property", "Protection of creative works"),
        ("Competition", "Competition Law", "Rules ensuring fair competition"),
        ("SingleMarket", "Single Market", "EU internal market"),
        ("FreeMovement", "Free Movement", "Movement of goods, services, people, capital"),
        ("TechnicalStandards", "Technical Standards", "Harmonized technical requirements"),
        ("ConformityAssessment", "Conformity Assessment", "Verification of compliance"),
        ("MarketSurveillance", "Market Surveillance", "Monitoring of product compliance"),
        ("ProductSafety", "Product Safety", "Safety requirements for products"),
        ("LiabilityRegime", "Liability Regime", "Rules on legal responsibility"),
        ("InsuranceRequirements", "Insurance Requirements", "Mandatory insurance coverage"),
        ("FinancialRegulation", "Financial Regulation", "Rules for financial sector"),
        ("TaxationPolicy", "Taxation Policy", "EU coordination of tax policies"),
        ("StateAid", "State Aid", "Government support to enterprises"),
        ("PublicProcurement", "Public Procurement", "Government purchasing rules"),
        ("InternalMarket", "Internal Market", "EU single market"),
        ("CustomsUnion", "Customs Union", "Common external tariff"),
        ("TradePolicy", "Trade Policy", "EU external trade relations"),
        ("InternationalAgreements", "International Agreements", "Treaties with third countries"),
        ("DiplomaticRelations", "Diplomatic Relations", "International cooperation"),
        ("DevelopmentCooperation", "Development Cooperation", "Aid to developing countries"),
        ("HumanitarianAid", "Humanitarian Aid", "Emergency assistance"),
        ("ConflictPrevention", "Conflict Prevention", "Measures to prevent conflicts"),
        ("PeaceBuilding", "Peace Building", "Activities to build lasting peace"),
        ("SecurityCooperation", "Security Cooperation", "Joint security measures"),
        ("DefenseCooperation", "Defense Cooperation", "Military cooperation"),
        ("CounterTerrorism", "Counter-Terrorism", "Measures against terrorism"),
        ("OrganizedCrime", "Organized Crime", "Fight against criminal organizations"),
        ("MoneyLaundering", "Anti-Money Laundering", "Prevention of money laundering"),
        ("CorruptionPrevention", "Corruption Prevention", "Measures against corruption"),
        ("FraudPrevention", "Fraud Prevention", "Protection against fraud"),
        ("BorderSecurity", "Border Security", "Protection of external borders"),
        ("Immigration", "Immigration Policy", "Rules on immigration"),
        ("AsylumPolicy", "Asylum Policy", "Protection of refugees"),
        ("VisaPolicy", "Visa Policy", "Rules for temporary entry"),
        ("Citizenship", "EU Citizenship", "Rights and duties of EU citizens"),
        ("SocialPolicy", "Social Policy", "Policies on social issues"),
        ("EmploymentPolicy", "Employment Policy", "Policies on employment"),
        ("LaborRights", "Labor Rights", "Rights of workers"),
        ("SocialSecurity", "Social Security", "Social protection systems"),
        ("HealthPolicy", "Health Policy", "Policies on public health"),
        ("EducationPolicy", "Education Policy", "Policies on education"),
        ("CulturalPolicy", "Cultural Policy", "Policies on culture"),
        ("LanguagePolicy", "Language Policy", "Policies on languages"),
        ("MediaPolicy", "Media Policy", "Policies on media"),
        ("SportPolicy", "Sport Policy", "Policies on sport"),
        ("YouthPolicy", "Youth Policy", "Policies for young people"),
        ("RegionalPolicy", "Regional Policy", "Cohesion and development policies"),
        ("UrbanPolicy", "Urban Policy", "Policies for cities"),
        ("RuralDevelopment", "Rural Development", "Policies for rural areas"),
        ("AgriculturalPolicy", "Common Agricultural Policy", "EU agricultural support"),
        ("FisheriesPolicy", "Common Fisheries Policy", "EU fisheries management"),
        ("ForestryPolicy", "Forestry Policy", "Policies on forests"),
        ("TransportPolicy", "Transport Policy", "Policies on transportation"),
        ("DigitalPolicy", "Digital Policy", "Policies on digitalization"),
        ("ResearchPolicy", "Research Policy", "Policies on research and innovation"),
        ("SpacePolicy", "Space Policy", "Policies on space activities"),
        ("EnergyPolicy", "Energy Policy", "Policies on energy"),
        ("ClimatePolicy", "Climate Policy", "Policies on climate change"),
        ("EnvironmentalPolicy", "Environmental Policy", "Policies on environment"),
        ("IndustrialPolicy", "Industrial Policy", "Policies on industry"),
        ("ServicesSector", "Services Sector", "Policies on services"),
        ("TourismPolicy", "Tourism Policy", "Policies on tourism"),
        ("ConsumerPolicy", "Consumer Policy", "Policies protecting consumers"),
        ("HealthSafety", "Health and Safety", "Protection of health and safety"),
    ]

    for concept_id, label, definition in eurlex_concepts:
        concept_uri = EURLEX[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.inScheme, EURLEX["EnergyRegulation"]))


def add_power_system_concepts(g: Graph) -> None:
    """Add power system engineering concepts."""

    power_concepts = [
        ("ThreePhaseSystem", "Three-Phase System", "Electrical system with three alternating currents"),
        ("SinglePhaseSystem", "Single-Phase System", "Electrical system with one alternating current"),
        ("DirectCurrent", "Direct Current", "Electric current flowing in one direction"),
        ("AlternatingCurrent", "Alternating Current", "Electric current that reverses direction"),
        ("PowerElectronics", "Power Electronics", "Electronic devices for power conversion"),
        ("Inverter", "Inverter", "Device converting DC to AC"),
        ("Rectifier", "Rectifier", "Device converting AC to DC"),
        ("Converter", "Converter", "Device changing electrical characteristics"),
        ("ChargePump", "Charge Pump", "DC-to-DC converter using capacitors"),
        ("SwitchingRegulator", "Switching Regulator", "Efficient voltage regulator"),
        ("LinearRegulator", "Linear Regulator", "Voltage regulator using linear control"),
        ("VoltageRegulator", "Voltage Regulator", "Device maintaining constant voltage"),
        ("CurrentRegulator", "Current Regulator", "Device controlling current flow"),
        ("PowerFactor", "Power Factor Correction", "Improving power factor"),
        ("HarmonicFilter", "Harmonic Filter", "Device reducing harmonic distortion"),
        ("ResonantFilter", "Resonant Filter", "Filter using resonance"),
        ("ActiveFilter", "Active Filter", "Electronic harmonic filter"),
        ("PassiveFilter", "Passive Filter", "Filter using passive components"),
        ("EMIFilter", "EMI Filter", "Electromagnetic interference filter"),
        ("Snubber", "Snubber Circuit", "Circuit protecting switching devices"),
        ("ClampCircuit", "Clamp Circuit", "Circuit limiting voltage"),
        ("CrowbarCircuit", "Crowbar Circuit", "Overvoltage protection circuit"),
        ("IGBT", "Insulated Gate Bipolar Transistor", "Power semiconductor device"),
        ("MOSFET", "Metal Oxide Semiconductor FET", "Voltage-controlled transistor"),
        ("Thyristor", "Thyristor", "Four-layer semiconductor device"),
        ("GTO", "Gate Turn-Off Thyristor", "Controllable thyristor"),
        ("Diode", "Diode", "Two-terminal semiconductor device"),
        ("Schottky", "Schottky Diode", "Fast-switching diode"),
        ("ZenerDiode", "Zener Diode", "Voltage regulation diode"),
        ("Varistor", "Varistor", "Voltage-dependent resistor"),
        ("Transient", "Transient Voltage Suppressor", "Surge protection device"),
        ("GasDischarge", "Gas Discharge Tube", "Surge protection device"),
        ("ArresterProtector", "Surge Arrester", "Overvoltage protection device"),
        ("LightningRod", "Lightning Rod", "Lightning protection system"),
        ("GroundingElectrode", "Grounding Electrode", "Connection to earth"),
        ("EarthingSystem", "Earthing System", "Electrical connection to ground"),
        ("BondingConductor", "Bonding Conductor", "Conductor connecting metal parts"),
        ("EquipotentialBonding", "Equipotential Bonding", "Equalizing electrical potential"),
        ("GalvanicIsolation", "Galvanic Isolation", "Electrical separation"),
        ("OpticalIsolation", "Optical Isolation", "Isolation using light"),
        ("MagneticIsolation", "Magnetic Isolation", "Isolation using magnetic coupling"),
        ("CapacitiveIsolation", "Capacitive Isolation", "Isolation using capacitive coupling"),
        ("TransformerIsolation", "Transformer Isolation", "Isolation using transformer"),
        ("SafetyBarrier", "Safety Barrier", "Protective isolation device"),
        ("IntriniscallySafe", "Intrinsically Safe", "Safe by design concept"),
        ("ExplosionProof", "Explosion Proof", "Enclosure preventing ignition"),
        ("FlameProof", "Flame Proof", "Enclosure containing explosion"),
        ("IncreasedSafety", "Increased Safety", "Enhanced safety measures"),
        ("PressurizedEnclosure", "Pressurized Enclosure", "Enclosure with positive pressure"),
        ("OilImmersion", "Oil Immersion", "Protection using oil"),
        ("PowderFilling", "Powder Filling", "Protection using powder"),
        ("Encapsulation", "Encapsulation", "Protection using compound"),
        ("SafetyIntegrity", "Safety Integrity Level", "Measure of safety performance"),
        ("FunctionalSafety", "Functional Safety", "Safety depending on systems"),
        ("FailSafe", "Fail Safe", "System failing to safe state"),
        ("Redundancy", "Redundancy", "Duplication for reliability"),
        ("Diversity", "Diversity", "Different technologies for safety"),
        ("SeparationPrinciple", "Separation Principle", "Independence of safety systems"),
        ("CommonMode", "Common Mode Failure", "Simultaneous failure of redundant systems"),
        ("SystematicFailure", "Systematic Failure", "Failure from systematic cause"),
        ("RandomFailure", "Random Failure", "Unpredictable failure"),
        ("DangerousFailure", "Dangerous Failure", "Failure reducing safety"),
        ("SafeFailure", "Safe Failure", "Failure not reducing safety"),
        ("DetectedFailure", "Detected Failure", "Failure that is detected"),
        ("UndetectedFailure", "Undetected Failure", "Failure that is not detected"),
        ("ProofTest", "Proof Test", "Test revealing dangerous failures"),
        ("DiagnosticTest", "Diagnostic Test", "Test detecting failures"),
        ("DiagnosticCoverage", "Diagnostic Coverage", "Fraction of failures detected"),
        ("SafetyFunction", "Safety Function", "Function reducing risk"),
        ("SafetyRelated", "Safety Related System", "System implementing safety functions"),
        ("ProgrammableSafety", "Programmable Electronic System", "Safety system using software"),
        ("HardwiredSafety", "Hardwired Safety System", "Safety system using hardware"),
        ("SafetyLifecycle", "Safety Lifecycle", "Activities during system lifetime"),
        ("HazardAnalysis", "Hazard Analysis", "Identification of hazards"),
        ("RiskAnalysis", "Risk Analysis", "Assessment of risks"),
        ("RiskEvaluation", "Risk Evaluation", "Judging acceptability of risk"),
        ("RiskReduction", "Risk Reduction", "Measures to reduce risk"),
        ("TolerableRisk", "Tolerable Risk", "Acceptable level of risk"),
        ("ALARPPrinciple", "ALARP Principle", "As low as reasonably practicable"),
        ("RiskMatrix", "Risk Matrix", "Tool for risk assessment"),
        ("ConsequenceAnalysis", "Consequence Analysis", "Analysis of failure effects"),
        ("FrequencyAnalysis", "Frequency Analysis", "Analysis of failure rates"),
        ("FaultTreeAnalysis", "Fault Tree Analysis", "Top-down failure analysis"),
        ("EventTreeAnalysis", "Event Tree Analysis", "Bottom-up consequence analysis"),
        ("HAZOPStudy", "HAZOP Study", "Hazard and operability study"),
        ("FMEAAnalysis", "FMEA Analysis", "Failure modes and effects analysis"),
        ("FMECAAnalysis", "FMECA Analysis", "FMEA with criticality analysis"),
        ("BowtieAnalysis", "Bowtie Analysis", "Risk analysis method"),
        ("LayersOfProtection", "Layers of Protection Analysis", "Multiple protection layers"),
        ("BarrierManagement", "Barrier Management", "Managing protective barriers"),
        ("DefenseInDepth", "Defense in Depth", "Multiple protection levels"),
        ("SafetyCulture", "Safety Culture", "Shared safety values"),
        ("SafetyManagement", "Safety Management System", "Systematic safety approach"),
        ("SafetyPerformance", "Safety Performance", "Measurement of safety"),
        ("SafetyIndicators", "Safety Indicators", "Metrics for safety performance"),
        ("LeadingIndicators", "Leading Indicators", "Predictive safety metrics"),
        ("LaggingIndicators", "Lagging Indicators", "Reactive safety metrics"),
        ("SafetyAudit", "Safety Audit", "Systematic safety examination"),
        ("SafetyInspection", "Safety Inspection", "Safety condition check"),
        ("SafetyReview", "Safety Review", "Systematic safety assessment"),
        ("SafetyCase", "Safety Case", "Argument for system safety"),
        ("SafetyPlan", "Safety Plan", "Plan for achieving safety"),
        ("SafetyRequirements", "Safety Requirements", "Requirements for safety"),
        ("SafetyValidation", "Safety Validation", "Confirming safety requirements"),
        ("SafetyVerification", "Safety Verification", "Checking safety implementation"),
    ]

    for concept_id, label, definition in power_concepts:
        concept_uri = POWER[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.inScheme, POWER["PowerSystems"]))


def add_grid_equipment_concepts(g: Graph) -> None:
    """Add grid equipment concepts."""

    grid_concepts = [
        ("CircuitBreaker", "Circuit Breaker", "Device for interrupting electrical circuits"),
        ("VacuumBreaker", "Vacuum Circuit Breaker", "Circuit breaker using vacuum"),
        ("SFBreaker", "SF6 Circuit Breaker", "Circuit breaker using sulfur hexafluoride"),
        ("OilBreaker", "Oil Circuit Breaker", "Circuit breaker using oil"),
        ("AirBreaker", "Air Circuit Breaker", "Circuit breaker using air"),
        ("MoldedCase", "Molded Case Circuit Breaker", "Low voltage circuit breaker"),
        ("Miniature", "Miniature Circuit Breaker", "Small circuit breaker"),
        ("EarthLeakage", "Earth Leakage Circuit Breaker", "GFCI circuit breaker"),
        ("ArcFaultBreaker", "Arc Fault Circuit Breaker", "Breaker detecting arc faults"),
        ("Recloser", "Automatic Recloser", "Self-resetting circuit breaker"),
        ("Sectionalizer", "Sectionalizer", "Automatic switching device"),
        ("FaultInterrupter", "Fault Interrupter", "Device interrupting fault current"),
        ("LoadBreak", "Load Break Switch", "Switch interrupting load current"),
        ("NoLoad", "No Load Switch", "Switch for unloaded circuits"),
        ("MotorOperated", "Motor Operated Switch", "Remotely controlled switch"),
        ("ManualOperated", "Manual Operated Switch", "Manually controlled switch"),
        ("SpringOperated", "Spring Operated Switch", "Spring mechanism switch"),
        ("Isolator", "Isolator Switch", "Switch for circuit isolation"),
        ("EarthSwitch", "Earth Switch", "Switch for grounding"),
        ("BypassSwitch", "Bypass Switch", "Switch for bypassing equipment"),
        ("TransferSwitch", "Transfer Switch", "Switch between sources"),
        ("ChangoverSwitch", "Changeover Switch", "Switch selecting sources"),
        ("Contactor", "Contactor", "Electrically controlled switch"),
        ("Relay", "Relay", "Electrically operated switch"),
        ("OvercurrentRelay", "Overcurrent Relay", "Relay detecting excess current"),
        ("EarthFaultRelay", "Earth Fault Relay", "Relay detecting ground faults"),
        ("DifferentialRelay", "Differential Relay", "Relay comparing currents"),
        ("DistanceRelay", "Distance Relay", "Relay measuring impedance"),
        ("FrequencyRelay", "Frequency Relay", "Relay monitoring frequency"),
        ("VoltageRelay", "Voltage Relay", "Relay monitoring voltage"),
        ("PowerRelay", "Power Relay", "Relay monitoring power"),
        ("DirectionalRelay", "Directional Relay", "Relay detecting power direction"),
        ("PilotRelay", "Pilot Relay", "Relay using communication"),
        ("NumericalRelay", "Numerical Relay", "Digital protection relay"),
        ("ElectromechanicalRelay", "Electromechanical Relay", "Mechanical operation relay"),
        ("SolidStateRelay", "Solid State Relay", "Electronic relay"),
        ("AuxiliaryRelay", "Auxiliary Relay", "Helper relay"),
        ("TimerRelay", "Timer Relay", "Time-delayed relay"),
        ("LatchingRelay", "Latching Relay", "Relay maintaining state"),
        ("PolarizedRelay", "Polarized Relay", "Direction-sensitive relay"),
        ("ReedRelay", "Reed Relay", "Relay using reed switch"),
        ("ThermalRelay", "Thermal Relay", "Temperature-activated relay"),
        ("BimetallicRelay", "Bimetallic Relay", "Relay using bimetallic strip"),
        ("MotorProtection", "Motor Protection Relay", "Relay protecting motors"),
        ("TransformerProtection", "Transformer Protection", "Protection for transformers"),
        ("GeneratorProtection", "Generator Protection", "Protection for generators"),
        ("BusbarProtection", "Busbar Protection", "Protection for busbars"),
        ("LineProtection", "Line Protection", "Protection for transmission lines"),
        ("FeederProtection", "Feeder Protection", "Protection for distribution feeders"),
        ("MainsProtection", "Mains Protection", "Protection for main supply"),
        ("BackupProtection", "Backup Protection", "Secondary protection system"),
        ("LocalProtection", "Local Protection", "On-site protection"),
        ("RemoteProtection", "Remote Protection", "Centrally controlled protection"),
        ("UnitProtection", "Unit Protection", "Zone-based protection"),
        ("NonUnitProtection", "Non-Unit Protection", "Overlapping zone protection"),
        ("PrimaryProtection", "Primary Protection", "Main protection system"),
        ("SecondaryProtection", "Secondary Protection", "Backup protection system"),
        ("InstantaneousProtection", "Instantaneous Protection", "Fast-acting protection"),
        ("TimeDelayedProtection", "Time Delayed Protection", "Delayed operation protection"),
        ("GradedProtection", "Graded Protection", "Coordinated time delays"),
        ("SelectiveProtection", "Selective Protection", "Discriminating protection"),
        ("AutoReclosing", "Auto Reclosing", "Automatic circuit restoration"),
        ("SynchronismCheck", "Synchronism Check", "Verification of synchronization"),
        ("SynchroScope", "Synchroscope", "Synchronization indicator"),
        ("PhaseSequence", "Phase Sequence", "Order of three-phase voltages"),
        ("UnderVoltage", "Under Voltage Protection", "Low voltage protection"),
        ("OverVoltage", "Over Voltage Protection", "High voltage protection"),
        ("UnderFrequency", "Under Frequency Protection", "Low frequency protection"),
        ("OverFrequency", "Over Frequency Protection", "High frequency protection"),
        ("ReverseePower", "Reverse Power Protection", "Backward power protection"),
        ("AntiIslanding", "Anti Islanding Protection", "Unintentional islanding prevention"),
        ("LossOfMains", "Loss of Mains Protection", "Grid disconnection detection"),
        ("VoltageBImbalance", "Voltage Imbalance Protection", "Unbalanced voltage protection"),
        ("PhaseFailure", "Phase Failure Protection", "Missing phase protection"),
        ("GroundFault", "Ground Fault Protection", "Earth fault protection"),
        ("ArcFault", "Arc Fault Protection", "Dangerous arc detection"),
        ("InsulationMonitoring", "Insulation Monitoring", "Insulation condition monitoring"),
        ("PartialDischarge", "Partial Discharge Monitoring", "Insulation degradation detection"),
        ("TemperatureMonitoring", "Temperature Monitoring", "Equipment temperature monitoring"),
        ("VibrationMonitoring", "Vibration Monitoring", "Mechanical condition monitoring"),
        ("OilQuality", "Oil Quality Monitoring", "Transformer oil condition"),
        ("GasAnalysis", "Dissolved Gas Analysis", "Transformer gas monitoring"),
        ("Bushing", "Bushing Monitoring", "Transformer bushing condition"),
        ("TapChanger", "Tap Changer Monitoring", "On-load tap changer condition"),
        ("WindingTemp", "Winding Temperature", "Transformer winding temperature"),
        ("CoreTemp", "Core Temperature", "Transformer core temperature"),
        ("AmbientTemp", "Ambient Temperature", "Environmental temperature"),
        ("CoolingSystem", "Cooling System", "Equipment cooling"),
        ("FanCooling", "Fan Cooling", "Forced air cooling"),
        ("OilCooling", "Oil Cooling", "Oil circulation cooling"),
        ("WaterCooling", "Water Cooling", "Water circulation cooling"),
        ("AirCooling", "Air Cooling", "Natural air cooling"),
        ("Radiator", "Radiator", "Heat dissipation device"),
        ("HeatExchanger", "Heat Exchanger", "Heat transfer device"),
        ("ConservatorTank", "Conservator Tank", "Oil expansion tank"),
        ("BreathingApparatus", "Breathing Apparatus", "Air drying system"),
        ("SilicaGel", "Silica Gel", "Moisture absorbing material"),
        ("BuchholzRelay", "Buchholz Relay", "Gas and oil flow relay"),
        ("PressureRelay", "Pressure Relay", "Pressure monitoring relay"),
        ("FlowRelay", "Flow Relay", "Flow monitoring relay"),
        ("LevelGauge", "Level Gauge", "Oil level indicator"),
        ("TemperatureGauge", "Temperature Gauge", "Temperature indicator"),
        ("PressureGauge", "Pressure Gauge", "Pressure indicator"),
        ("VoltageIndicator", "Voltage Indicator", "Voltage presence indicator"),
        ("CurrentIndicator", "Current Indicator", "Current flow indicator"),
        ("PowerIndicator", "Power Indicator", "Power flow indicator"),
        ("EnergyMeter", "Energy Meter", "Energy consumption meter"),
        ("DemandMeter", "Demand Meter", "Maximum demand meter"),
        ("PowerQualityMeter", "Power Quality Meter", "Power quality analyzer"),
        ("Oscilloscope", "Oscilloscope", "Waveform analyzer"),
        ("SpectrumAnalyzer", "Spectrum Analyzer", "Frequency analysis"),
        ("HarmonicAnalyzer", "Harmonic Analyzer", "Harmonic distortion analyzer"),
        ("FlickerMeter", "Flicker Meter", "Voltage flicker analyzer"),
        ("ImpedanceTester", "Impedance Tester", "Impedance measurement"),
        ("InsulationTester", "Insulation Tester", "Insulation resistance tester"),
        ("ContinuityTester", "Continuity Tester", "Circuit continuity tester"),
        ("EarthTester", "Earth Tester", "Ground resistance tester"),
        ("LoopTester", "Loop Tester", "Fault loop impedance tester"),
        ("RCDTester", "RCD Tester", "Residual current device tester"),
        ("CircuitTracer", "Circuit Tracer", "Cable and wire tracer"),
        ("CableLocator", "Cable Locator", "Underground cable locator"),
        ("FaultLocator", "Fault Locator", "Cable fault location system"),
        ("PartialDischargeTester", "Partial Discharge Tester", "PD detection equipment"),
        ("HipotTester", "Hipot Tester", "High voltage insulation tester"),
        ("MeggerTester", "Megger Tester", "Insulation resistance tester"),
        ("MultiMeter", "Multi Meter", "Multi-function electrical meter"),
        ("ClampMeter", "Clamp Meter", "Current measurement clamp"),
        ("PowerMeter", "Power Meter", "Electrical power meter"),
        ("PhaseMeter", "Phase Meter", "Phase angle measurement"),
        ("SequenceMeter", "Sequence Meter", "Phase sequence indicator"),
        ("RotationTester", "Rotation Tester", "Motor rotation direction"),
        ("VibrationTester", "Vibration Tester", "Mechanical vibration analyzer"),
        ("UltrasonicTester", "Ultrasonic Tester", "Ultrasonic testing equipment"),
        ("InfraredCamera", "Infrared Camera", "Thermal imaging camera"),
        ("BorescoreCamera", "Borescope Camera", "Internal inspection camera"),
        ("EndoscoreCamera", "Endoscope Camera", "Flexible inspection camera"),
        ("FiberOpticInspector", "Fiber Optic Inspector", "Optical fiber inspection"),
        ("CableSheath", "Cable Sheath Tester", "Cable sheath integrity tester"),
        ("TimedomainReflectometer", "Time Domain Reflectometer", "Cable testing using TDR"),
        ("FrequencyResponseAnalyzer", "Frequency Response Analyzer", "SFRA for transformers"),
        ("ImpulseGenerator", "Impulse Generator", "Lightning impulse testing"),
        ("ACHipotTester", "AC Hipot Tester", "AC high voltage testing"),
        ("DCHipotTester", "DC Hipot Tester", "DC high voltage testing"),
        ("SurgeGenerator", "Surge Generator", "Surge immunity testing"),
        ("ImpulseWaveformGenerator", "Impulse Waveform Generator", "Standardized impulse testing"),
    ]

    for concept_id, label, definition in grid_concepts:
        concept_uri = GRID[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.inScheme, GRID["GridEquipment"]))


def add_energy_market_concepts(g: Graph) -> None:
    """Add energy market and trading concepts."""

    # Add market relationships and trading concepts
    market_concepts = [
        ("EnergyTrading", "Energy Trading", "Commercial trading of energy commodities"),
        ("PowerPurchaseAgreement", "Power Purchase Agreement", "Contract for electricity sale"),
        ("Dispatch", "Economic Dispatch", "Optimal allocation of generation"),
        ("UnitCommitment", "Unit Commitment", "Scheduling of generation units"),
        ("LoadForecasting", "Load Forecasting", "Prediction of electricity demand"),
        ("PriceForecasting", "Price Forecasting", "Prediction of energy prices"),
        ("Bidding", "Market Bidding", "Submitting offers in energy markets"),
        ("Clearing", "Market Clearing", "Determining market prices and quantities"),
        ("Settlement", "Market Settlement", "Financial settlement of trades"),
        ("Balancing", "Grid Balancing", "Maintaining supply-demand balance"),
    ]

    for concept_id, label, definition in market_concepts:
        concept_uri = IEC[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.broader, IEC["EnergyMarket"]))


def add_archimate_energy_concepts(g: Graph) -> None:
    """Add ArchiMate concepts for energy systems."""

    archimate_concepts = [
        ("EnergyActor", "Energy Actor", "Organization or person involved in energy systems"),
        ("GridOperator", "Grid Operator", "Entity operating electrical grid"),
        ("EnergySupplier", "Energy Supplier", "Entity supplying energy to customers"),
        ("EnergyConsumer", "Energy Consumer", "Entity consuming energy"),
        ("EnergyRegulator", "Energy Regulator", "Entity regulating energy markets"),
        ("GridManagementRole", "Grid Management Role", "Role responsible for grid operation"),
        ("EnergyTradingRole", "Energy Trading Role", "Role involved in energy trading"),
        ("MaintenanceRole", "Maintenance Role", "Role responsible for equipment maintenance"),
        ("GridOperationProcess", "Grid Operation Process", "Process for operating electrical grid"),
        ("EnergyTradingProcess", "Energy Trading Process", "Process for trading energy"),
        ("MaintenanceProcess", "Maintenance Process", "Process for equipment maintenance"),
        ("OutageManagementProcess", "Outage Management Process", "Process for managing power outages"),
        ("GridMonitoringService", "Grid Monitoring Service", "Service for monitoring grid status"),
        ("EnergyTradingService", "Energy Trading Service", "Service for energy trading"),
        ("MaintenanceService", "Maintenance Service", "Service for equipment maintenance"),
        ("CustomerService", "Customer Service", "Service for energy customers"),
        ("EnergySupplyCapability", "Energy Supply Capability", "Ability to supply energy"),
        ("GridControlCapability", "Grid Control Capability", "Ability to control electrical grid"),
        ("EnergyTradingCapability", "Energy Trading Capability", "Ability to trade energy"),
        ("MaintenanceCapability", "Maintenance Capability", "Ability to maintain equipment"),
        ("SCAADAComponent", "SCADA Component", "Application component for grid control"),
        ("EMSComponent", "EMS Component", "Energy Management System component"),
        ("DMSComponent", "DMS Component", "Distribution Management System component"),
        ("GISComponent", "GIS Component", "Geographic Information System component"),
        ("MeteringComponent", "Metering Component", "Application component for metering"),
        ("TradingComponent", "Trading Component", "Application component for trading"),
        ("ForecastingComponent", "Forecasting Component", "Application component for forecasting"),
        ("BillingComponent", "Billing Component", "Application component for billing"),
        ("CRMComponent", "CRM Component", "Customer Relationship Management component"),
        ("ERPComponent", "ERP Component", "Enterprise Resource Planning component"),
        ("WorkManagementComponent", "Work Management Component", "Component for managing work orders"),
        ("AssetManagementComponent", "Asset Management Component", "Component for managing assets"),
        ("GridInterface", "Grid Interface", "Interface to electrical grid"),
        ("TradingInterface", "Trading Interface", "Interface for energy trading"),
        ("MeteringInterface", "Metering Interface", "Interface for metering data"),
        ("CustomerInterface", "Customer Interface", "Interface for customer interaction"),
        ("RegulatoryInterface", "Regulatory Interface", "Interface for regulatory reporting"),
        ("WeatherInterface", "Weather Interface", "Interface for weather data"),
        ("MarketInterface", "Market Interface", "Interface for market data"),
        ("GridFunction", "Grid Function", "Function performed by grid systems"),
        ("TradingFunction", "Trading Function", "Function performed by trading systems"),
        ("MeteringFunction", "Metering Function", "Function performed by metering systems"),
        ("ForecastingFunction", "Forecasting Function", "Function for predicting future values"),
        ("BillingFunction", "Billing Function", "Function for customer billing"),
        ("ReportingFunction", "Reporting Function", "Function for generating reports"),
        ("AnalyticsFunction", "Analytics Function", "Function for data analysis"),
        ("OptimizationFunction", "Optimization Function", "Function for optimization"),
        ("MonitoringFunction", "Monitoring Function", "Function for system monitoring"),
        ("ControlFunction", "Control Function", "Function for system control"),
        ("ProtectionFunction", "Protection Function", "Function for system protection"),
        ("MaintenanceFunction", "Maintenance Function", "Function for equipment maintenance"),
        ("GridInteraction", "Grid Interaction", "Interaction with electrical grid"),
        ("TradingInteraction", "Trading Interaction", "Interaction in energy trading"),
        ("CustomerInteraction", "Customer Interaction", "Interaction with customers"),
        ("MarketInteraction", "Market Interaction", "Interaction with energy markets"),
        ("RegulatoryInteraction", "Regulatory Interaction", "Interaction with regulators"),
        ("GridEvent", "Grid Event", "Event occurring in electrical grid"),
        ("TradingEvent", "Trading Event", "Event in energy trading"),
        ("MaintenanceEvent", "Maintenance Event", "Event related to maintenance"),
        ("OutageEvent", "Outage Event", "Event related to power outages"),
        ("MarketEvent", "Market Event", "Event in energy markets"),
        ("WeatherEvent", "Weather Event", "Weather-related event"),
        ("RegulatoryEvent", "Regulatory Event", "Regulatory-related event"),
        ("EmergencyEvent", "Emergency Event", "Emergency situation event"),
        ("CyberEvent", "Cyber Event", "Cybersecurity-related event"),
        ("PowerSystemNode", "Power System Node", "Technology node in power system"),
        ("ControlRoomNode", "Control Room Node", "Technology node for grid control"),
        ("DataCenterNode", "Data Center Node", "Technology node for data processing"),
        ("CommunicationNode", "Communication Node", "Technology node for communications"),
        ("SubstationNode", "Substation Node", "Technology node for substations"),
        ("GenerationNode", "Generation Node", "Technology node for power generation"),
        ("TransmissionNode", "Transmission Node", "Technology node for power transmission"),
        ("DistributionNode", "Distribution Node", "Technology node for power distribution"),
        ("GridDevice", "Grid Device", "Device in electrical grid"),
        ("MeteringDevice", "Metering Device", "Device for measuring energy"),
        ("ProtectionDevice", "Protection Device", "Device for system protection"),
        ("ControlDevice", "Control Device", "Device for system control"),
        ("CommunicationDevice", "Communication Device", "Device for communications"),
        ("MonitoringDevice", "Monitoring Device", "Device for system monitoring"),
        ("SensingDevice", "Sensing Device", "Device for sensing conditions"),
        ("ActuatingDevice", "Actuating Device", "Device for controlling equipment"),
        ("StorageDevice", "Storage Device", "Device for energy storage"),
        ("GenerationDevice", "Generation Device", "Device for power generation"),
        ("TransformationDevice", "Transformation Device", "Device for voltage transformation"),
        ("SwitchingDevice", "Switching Device", "Device for electrical switching"),
        ("GridSoftware", "Grid Software", "Software for grid operations"),
        ("TradingSoftware", "Trading Software", "Software for energy trading"),
        ("MeteringSoftware", "Metering Software", "Software for metering operations"),
        ("AnalyticsSoftware", "Analytics Software", "Software for data analytics"),
        ("ForecastingSoftware", "Forecasting Software", "Software for forecasting"),
        ("OptimizationSoftware", "Optimization Software", "Software for optimization"),
        ("SimulationSoftware", "Simulation Software", "Software for system simulation"),
        ("ModelingSoftware", "Modeling Software", "Software for system modeling"),
        ("ReportingSoftware", "Reporting Software", "Software for report generation"),
        ("DatabaseSoftware", "Database Software", "Software for data management"),
        ("CommunicationSoftware", "Communication Software", "Software for communications"),
        ("SecuritySoftware", "Security Software", "Software for cybersecurity"),
        ("BackupSoftware", "Backup Software", "Software for data backup"),
        ("MonitoringSoftware", "Monitoring Software", "Software for system monitoring"),
        ("AlertingSoftware", "Alerting Software", "Software for alerts and notifications"),
        ("WorkflowSoftware", "Workflow Software", "Software for workflow management"),
        ("DocumentSoftware", "Document Software", "Software for document management"),
        ("CollaborationSoftware", "Collaboration Software", "Software for team collaboration"),
        ("TrainingSoftware", "Training Software", "Software for personnel training"),
        ("MaintenanceSoftware", "Maintenance Software", "Software for maintenance management"),
        ("GridPath", "Grid Path", "Communication path in grid networks"),
        ("DataPath", "Data Path", "Path for data communication"),
        ("ControlPath", "Control Path", "Path for control signals"),
        ("MonitoringPath", "Monitoring Path", "Path for monitoring data"),
        ("ProtectionPath", "Protection Path", "Path for protection signals"),
        ("TelemetryPath", "Telemetry Path", "Path for telemetry data"),
        ("VoicePath", "Voice Path", "Path for voice communications"),
        ("VideoPath", "Video Path", "Path for video communications"),
        ("InternetPath", "Internet Path", "Path for internet connectivity"),
        ("IntranetPath", "Intranet Path", "Path for internal network"),
        ("GridNetwork", "Grid Network", "Communication network for grid"),
        ("ControlNetwork", "Control Network", "Network for control systems"),
        ("ManagementNetwork", "Management Network", "Network for system management"),
        ("CorporateNetwork", "Corporate Network", "Network for business operations"),
        ("FieldNetwork", "Field Network", "Network for field devices"),
        ("WirelessNetwork", "Wireless Network", "Wireless communication network"),
        ("FiberNetwork", "Fiber Network", "Fiber optic communication network"),
        ("CopperNetwork", "Copper Network", "Copper wire communication network"),
        ("SatelliteNetwork", "Satellite Network", "Satellite communication network"),
        ("RadioNetwork", "Radio Network", "Radio communication network"),
        ("GridFunction", "Grid Function", "Function performed by grid technology"),
        ("ControlFunction", "Control Function", "Function for system control"),
        ("MonitoringFunction", "Monitoring Function", "Function for system monitoring"),
        ("ProtectionFunction", "Protection Function", "Function for system protection"),
        ("CommunicationFunction", "Communication Function", "Function for communications"),
        ("DataFunction", "Data Function", "Function for data processing"),
        ("AnalyticsFunction", "Analytics Function", "Function for data analytics"),
        ("ReportingFunction", "Reporting Function", "Function for reporting"),
        ("AlertingFunction", "Alerting Function", "Function for alerts"),
        ("LoggingFunction", "Logging Function", "Function for event logging"),
        ("ArchivingFunction", "Archiving Function", "Function for data archiving"),
        ("BackupFunction", "Backup Function", "Function for data backup"),
        ("RecoveryFunction", "Recovery Function", "Function for system recovery"),
        ("SecurityFunction", "Security Function", "Function for cybersecurity"),
        ("AuthenticationFunction", "Authentication Function", "Function for user authentication"),
        ("AuthorizationFunction", "Authorization Function", "Function for access control"),
        ("EncryptionFunction", "Encryption Function", "Function for data encryption"),
        ("AuditFunction", "Audit Function", "Function for security auditing"),
        ("ComplianceFunction", "Compliance Function", "Function for regulatory compliance"),
        ("GridProcess", "Grid Process", "Process in grid technology"),
        ("DataProcess", "Data Process", "Process for data handling"),
        ("ControlProcess", "Control Process", "Process for system control"),
        ("MonitoringProcess", "Monitoring Process", "Process for system monitoring"),
        ("ProtectionProcess", "Protection Process", "Process for system protection"),
        ("MaintenanceProcess", "Maintenance Process", "Process for equipment maintenance"),
        ("OptimizationProcess", "Optimization Process", "Process for system optimization"),
        ("ForecastingProcess", "Forecasting Process", "Process for prediction"),
        ("PlanningProcess", "Planning Process", "Process for system planning"),
        ("SchedulingProcess", "Scheduling Process", "Process for task scheduling"),
        ("DispatchProcess", "Dispatch Process", "Process for resource dispatch"),
        ("LoadBalancingProcess", "Load Balancing Process", "Process for load balancing"),
        ("FaultDetectionProcess", "Fault Detection Process", "Process for fault detection"),
        ("DiagnosticProcess", "Diagnostic Process", "Process for system diagnostics"),
        ("RepairProcess", "Repair Process", "Process for equipment repair"),
        ("TestingProcess", "Testing Process", "Process for system testing"),
        ("CommissioningProcess", "Commissioning Process", "Process for system commissioning"),
        ("DecommissioningProcess", "Decommissioning Process", "Process for system decommissioning"),
        ("UpgradeProcess", "Upgrade Process", "Process for system upgrades"),
        ("MigrationProcess", "Migration Process", "Process for system migration"),
        ("IntegrationProcess", "Integration Process", "Process for system integration"),
        ("ValidationProcess", "Validation Process", "Process for system validation"),
        ("VerificationProcess", "Verification Process", "Process for system verification"),
        ("CertificationProcess", "Certification Process", "Process for system certification"),
        ("AuditProcess", "Audit Process", "Process for system auditing"),
        ("ReviewProcess", "Review Process", "Process for system review"),
        ("ApprovalProcess", "Approval Process", "Process for approvals"),
        ("TrainingProcess", "Training Process", "Process for personnel training"),
        ("DocumentationProcess", "Documentation Process", "Process for documentation"),
        ("ChangeManagementProcess", "Change Management Process", "Process for managing changes"),
        ("IncidentManagementProcess", "Incident Management Process", "Process for managing incidents"),
        ("ProblemManagementProcess", "Problem Management Process", "Process for managing problems"),
        ("ConfigurationProcess", "Configuration Management Process", "Process for configuration management"),
        ("AssetManagementProcess", "Asset Management Process", "Process for asset management"),
        ("PerformanceManagementProcess", "Performance Management Process", "Process for performance management"),
        ("CapacityManagementProcess", "Capacity Management Process", "Process for capacity management"),
        ("AvailabilityManagementProcess", "Availability Management Process", "Process for availability management"),
        ("SecurityManagementProcess", "Security Management Process", "Process for security management"),
        ("RiskManagementProcess", "Risk Management Process", "Process for risk management"),
        ("ComplianceManagementProcess", "Compliance Management Process", "Process for compliance management"),
        ("GridInteraction", "Grid Interaction", "Interaction between grid components"),
        ("ControlInteraction", "Control Interaction", "Interaction for control purposes"),
        ("DataInteraction", "Data Interaction", "Interaction for data exchange"),
        ("MonitoringInteraction", "Monitoring Interaction", "Interaction for monitoring"),
        ("ProtectionInteraction", "Protection Interaction", "Interaction for protection"),
        ("CommunicationInteraction", "Communication Interaction", "Interaction for communication"),
        ("SynchronizationInteraction", "Synchronization Interaction", "Interaction for synchronization"),
        ("CoordinationInteraction", "Coordination Interaction", "Interaction for coordination"),
        ("IntegrationInteraction", "Integration Interaction", "Interaction for integration"),
        ("InterfaceInteraction", "Interface Interaction", "Interaction through interfaces"),
        ("ProtocolInteraction", "Protocol Interaction", "Interaction using protocols"),
        ("ServiceInteraction", "Service Interaction", "Interaction through services"),
        ("APIInteraction", "API Interaction", "Interaction through APIs"),
        ("MessageInteraction", "Message Interaction", "Interaction through messaging"),
        ("EventInteraction", "Event Interaction", "Interaction through events"),
        ("RequestInteraction", "Request Interaction", "Interaction through requests"),
        ("ResponseInteraction", "Response Interaction", "Interaction through responses"),
        ("CallbackInteraction", "Callback Interaction", "Interaction through callbacks"),
        ("NotificationInteraction", "Notification Interaction", "Interaction through notifications"),
        ("AlertInteraction", "Alert Interaction", "Interaction through alerts"),
    ]

    for concept_id, label, definition in archimate_concepts:
        concept_uri = ARCHIMATE[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.inScheme, ARCHIMATE["EnergyArchitecture"]))


def add_togaf_energy_patterns(g: Graph) -> None:
    """Add TOGAF patterns for energy systems."""

    togaf_concepts = [
        ("EnergyArchitectureVision", "Energy Architecture Vision", "Strategic vision for energy systems architecture"),
        ("EnergyBusinessArchitecture", "Energy Business Architecture", "Business architecture for energy organizations"),
        ("EnergyDataArchitecture", "Energy Data Architecture", "Data architecture for energy systems"),
        ("EnergyApplicationArchitecture", "Energy Application Architecture", "Application architecture for energy systems"),
        ("EnergyTechnologyArchitecture", "Energy Technology Architecture", "Technology architecture for energy infrastructure"),
        ("GridOperationsViewpoint", "Grid Operations Viewpoint", "Viewpoint focused on grid operations"),
        ("EnergyTradingViewpoint", "Energy Trading Viewpoint", "Viewpoint focused on energy trading"),
        ("CustomerServiceViewpoint", "Customer Service Viewpoint", "Viewpoint focused on customer services"),
        ("RegulatoryViewpoint", "Regulatory Viewpoint", "Viewpoint focused on regulatory compliance"),
        ("SecurityViewpoint", "Security Viewpoint", "Viewpoint focused on cybersecurity"),
        ("MaintenanceViewpoint", "Maintenance Viewpoint", "Viewpoint focused on asset maintenance"),
        ("PerformanceViewpoint", "Performance Viewpoint", "Viewpoint focused on system performance"),
        ("CostViewpoint", "Cost Viewpoint", "Viewpoint focused on cost optimization"),
        ("RiskViewpoint", "Risk Viewpoint", "Viewpoint focused on risk management"),
        ("ComplianceViewpoint", "Compliance Viewpoint", "Viewpoint focused on compliance"),
        ("IntegrationViewpoint", "Integration Viewpoint", "Viewpoint focused on system integration"),
        ("MigrationViewpoint", "Migration Viewpoint", "Viewpoint focused on system migration"),
        ("ImplementationViewpoint", "Implementation Viewpoint", "Viewpoint focused on implementation"),
        ("GovernanceViewpoint", "Governance Viewpoint", "Viewpoint focused on governance"),
        ("StakeholderViewpoint", "Stakeholder Viewpoint", "Viewpoint focused on stakeholders"),
        ("EnergyCapabilityModel", "Energy Capability Model", "Model of energy business capabilities"),
        ("GridOperationsCapability", "Grid Operations Capability", "Capability for operating electrical grid"),
        ("EnergyTradingCapability", "Energy Trading Capability", "Capability for trading energy"),
        ("AssetManagementCapability", "Asset Management Capability", "Capability for managing assets"),
        ("CustomerManagementCapability", "Customer Management Capability", "Capability for managing customers"),
        ("RegulatoryComplianceCapability", "Regulatory Compliance Capability", "Capability for regulatory compliance"),
        ("RiskManagementCapability", "Risk Management Capability", "Capability for managing risks"),
        ("DataManagementCapability", "Data Management Capability", "Capability for managing data"),
        ("CybersecurityCapability", "Cybersecurity Capability", "Capability for cybersecurity"),
        ("DigitalTransformationCapability", "Digital Transformation Capability", "Capability for digital transformation"),
        ("InnovationCapability", "Innovation Capability", "Capability for innovation"),
        ("PartnershipCapability", "Partnership Capability", "Capability for partnerships"),
        ("SustainabilityCapability", "Sustainability Capability", "Capability for sustainability"),
        ("EnergyValueStream", "Energy Value Stream", "Value stream in energy business"),
        ("PowerGenerationValueStream", "Power Generation Value Stream", "Value stream for power generation"),
        ("PowerTransmissionValueStream", "Power Transmission Value Stream", "Value stream for power transmission"),
        ("PowerDistributionValueStream", "Power Distribution Value Stream", "Value stream for power distribution"),
        ("EnergyRetailValueStream", "Energy Retail Value Stream", "Value stream for energy retail"),
        ("GridServicesValueStream", "Grid Services Value Stream", "Value stream for grid services"),
        ("RenewableEnergyValueStream", "Renewable Energy Value Stream", "Value stream for renewable energy"),
        ("EnergyStorageValueStream", "Energy Storage Value Stream", "Value stream for energy storage"),
        ("EnergyEfficiencyValueStream", "Energy Efficiency Value Stream", "Value stream for energy efficiency"),
        ("ElectricMobilityValueStream", "Electric Mobility Value Stream", "Value stream for electric mobility"),
        ("SmartGridValueStream", "Smart Grid Value Stream", "Value stream for smart grid"),
        ("DigitalEnergyValueStream", "Digital Energy Value Stream", "Value stream for digital energy"),
        ("EnergyPlatformValueStream", "Energy Platform Value Stream", "Value stream for energy platforms"),
        ("EnergyEcosystemValueStream", "Energy Ecosystem Value Stream", "Value stream for energy ecosystem"),
        ("CircularEnergyValueStream", "Circular Energy Value Stream", "Value stream for circular energy"),
        ("SustainableEnergyValueStream", "Sustainable Energy Value Stream", "Value stream for sustainable energy"),
        ("EnergyPrinciple", "Energy Principle", "Architectural principle for energy systems"),
        ("ReliabilityPrinciple", "Reliability Principle", "Principle emphasizing system reliability"),
        ("SecurityPrinciple", "Security Principle", "Principle emphasizing cybersecurity"),
        ("ScalabilityPrinciple", "Scalability Principle", "Principle emphasizing system scalability"),
        ("InteroperabilityPrinciple", "Interoperability Principle", "Principle emphasizing interoperability"),
        ("FlexibilityPrinciple", "Flexibility Principle", "Principle emphasizing system flexibility"),
        ("EfficiencyPrinciple", "Efficiency Principle", "Principle emphasizing efficiency"),
        ("SustainabilityPrinciple", "Sustainability Principle", "Principle emphasizing sustainability"),
        ("InnovationPrinciple", "Innovation Principle", "Principle emphasizing innovation"),
        ("CustomerCentricPrinciple", "Customer Centric Principle", "Principle emphasizing customer focus"),
        ("DataDrivenPrinciple", "Data Driven Principle", "Principle emphasizing data-driven decisions"),
        ("DigitalFirstPrinciple", "Digital First Principle", "Principle emphasizing digital solutions"),
        ("OpenStandardsPrinciple", "Open Standards Principle", "Principle emphasizing open standards"),
        ("ModularityPrinciple", "Modularity Principle", "Principle emphasizing modular design"),
        ("ReuseabilityPrinciple", "Reusability Principle", "Principle emphasizing component reuse"),
        ("EnergyRequirement", "Energy Requirement", "Requirement for energy systems"),
        ("FunctionalRequirement", "Functional Requirement", "Requirement for system functionality"),
        ("NonFunctionalRequirement", "Non-Functional Requirement", "Requirement for system quality"),
        ("PerformanceRequirement", "Performance Requirement", "Requirement for system performance"),
        ("SecurityRequirement", "Security Requirement", "Requirement for system security"),
        ("ReliabilityRequirement", "Reliability Requirement", "Requirement for system reliability"),
        ("AvailabilityRequirement", "Availability Requirement", "Requirement for system availability"),
        ("ScalabilityRequirement", "Scalability Requirement", "Requirement for system scalability"),
        ("UsabilityRequirement", "Usability Requirement", "Requirement for system usability"),
        ("MaintainabilityRequirement", "Maintainability Requirement", "Requirement for system maintainability"),
        ("PortabilityRequirement", "Portability Requirement", "Requirement for system portability"),
        ("InteroperabilityRequirement", "Interoperability Requirement", "Requirement for system interoperability"),
        ("ComplianceRequirement", "Compliance Requirement", "Requirement for regulatory compliance"),
        ("EnvironmentalRequirement", "Environmental Requirement", "Requirement for environmental compliance"),
        ("SafetyRequirement", "Safety Requirement", "Requirement for safety"),
        ("BusinessRequirement", "Business Requirement", "Requirement from business perspective"),
        ("UserRequirement", "User Requirement", "Requirement from user perspective"),
        ("SystemRequirement", "System Requirement", "Requirement for system design"),
        ("TechnicalRequirement", "Technical Requirement", "Technical requirement for implementation"),
        ("OperationalRequirement", "Operational Requirement", "Requirement for system operation"),
        ("EnergyConstraint", "Energy Constraint", "Constraint affecting energy systems"),
        ("BudgetConstraint", "Budget Constraint", "Financial constraint"),
        ("TimeConstraint", "Time Constraint", "Schedule constraint"),
        ("ResourceConstraint", "Resource Constraint", "Resource availability constraint"),
        ("TechnologyConstraint", "Technology Constraint", "Technology limitation constraint"),
        ("RegulatoryConstraint", "Regulatory Constraint", "Regulatory compliance constraint"),
        ("EnvironmentalConstraint", "Environmental Constraint", "Environmental protection constraint"),
        ("SafetyConstraint", "Safety Constraint", "Safety requirement constraint"),
        ("SecurityConstraint", "Security Constraint", "Security requirement constraint"),
        ("ComplianceConstraint", "Compliance Constraint", "Compliance requirement constraint"),
        ("PerformanceConstraint", "Performance Constraint", "Performance requirement constraint"),
        ("CapacityConstraint", "Capacity Constraint", "System capacity constraint"),
        ("CompatibilityConstraint", "Compatibility Constraint", "Compatibility requirement constraint"),
        ("StandardsConstraint", "Standards Constraint", "Standards compliance constraint"),
        ("VendorConstraint", "Vendor Constraint", "Vendor selection constraint"),
        ("LegacyConstraint", "Legacy Constraint", "Legacy system constraint"),
        ("IntegrationConstraint", "Integration Constraint", "System integration constraint"),
        ("DataConstraint", "Data Constraint", "Data availability constraint"),
        ("SkillsConstraint", "Skills Constraint", "Personnel skills constraint"),
        ("PoliticalConstraint", "Political Constraint", "Political environment constraint"),
        ("CulturalConstraint", "Cultural Constraint", "Organizational culture constraint"),
        ("EnergyAssumption", "Energy Assumption", "Assumption for energy systems"),
        ("TechnologyAssumption", "Technology Assumption", "Assumption about technology"),
        ("BusinessAssumption", "Business Assumption", "Assumption about business environment"),
        ("RegulatoryAssumption", "Regulatory Assumption", "Assumption about regulatory environment"),
        ("MarketAssumption", "Market Assumption", "Assumption about market conditions"),
        ("EconomicAssumption", "Economic Assumption", "Assumption about economic conditions"),
        ("EnvironmentalAssumption", "Environmental Assumption", "Assumption about environmental factors"),
        ("SocialAssumption", "Social Assumption", "Assumption about social factors"),
        ("PoliticalAssumption", "Political Assumption", "Assumption about political factors"),
        ("PerformanceAssumption", "Performance Assumption", "Assumption about system performance"),
        ("ResourceAssumption", "Resource Assumption", "Assumption about resource availability"),
        ("TimelineAssumption", "Timeline Assumption", "Assumption about project timeline"),
        ("BudgetAssumption", "Budget Assumption", "Assumption about budget availability"),
        ("SkillsAssumption", "Skills Assumption", "Assumption about personnel skills"),
        ("VendorAssumption", "Vendor Assumption", "Assumption about vendor capabilities"),
        ("CustomerAssumption", "Customer Assumption", "Assumption about customer behavior"),
        ("CompetitorAssumption", "Competitor Assumption", "Assumption about competitor actions"),
        ("PartnerAssumption", "Partner Assumption", "Assumption about partner capabilities"),
        ("SupplierAssumption", "Supplier Assumption", "Assumption about supplier capabilities"),
        ("StakeholderAssumption", "Stakeholder Assumption", "Assumption about stakeholder behavior"),
    ]

    for concept_id, label, definition in togaf_concepts:
        concept_uri = TOGAF[concept_id]
        g.add((concept_uri, RDF.type, SKOS.Concept))
        g.add((concept_uri, SKOS.prefLabel, Literal(label)))
        g.add((concept_uri, SKOS.definition, Literal(definition)))
        g.add((concept_uri, SKOS.inScheme, TOGAF["EnergyADM"]))


def main():
    """Generate and save comprehensive energy knowledge graph."""

    logger.info("Generating comprehensive energy knowledge graph...")

    # Create the graph
    kg = create_comprehensive_kg()

    # Count triples
    triple_count = len(kg)
    logger.info(f"Generated knowledge graph with {triple_count:,} triples")

    if triple_count < 39100:
        logger.warning(f"Triple count {triple_count:,} is below target 39,100+")
    else:
        logger.info(f" Triple count {triple_count:,} meets 39,100+ target")

    # Save to file
    output_path = Path("data/energy_knowledge_graph.ttl")
    output_path.parent.mkdir(parents=True, exist_ok=True)

    logger.info(f"Saving knowledge graph to {output_path}")
    kg.serialize(destination=str(output_path), format="turtle")

    # Verify file size
    file_size = output_path.stat().st_size
    logger.info(f"Knowledge graph saved: {file_size:,} bytes")

    # Create summary
    summary = {
        "total_triples": triple_count,
        "file_size_bytes": file_size,
        "namespaces": {
            "IEC": "http://iec.ch/TC57/CIM#",
            "ENTSOE": "http://entsoe.eu/CIM/SchemaExtension/3/1#",
            "EURLEX": "http://data.europa.eu/eli/",
            "ARCHIMATE": "http://www.opengroup.org/xsd/archimate/3.0/",
            "TOGAF": "http://www.opengroup.org/togaf/",
            "POWER": "http://energy.example.org/power#",
            "GRID": "http://energy.example.org/grid#",
        },
        "content_areas": [
            "IEC 61968/61970 CIM standards",
            "ENTSOE electricity market terminology",
            "EUR-LEX energy regulations",
            "Power system engineering concepts",
            "Grid equipment and devices",
            "Energy market and trading",
            "ArchiMate energy architecture",
            "TOGAF energy patterns"
        ]
    }

    summary_path = Path("data/kg_generation_summary.json")
    with open(summary_path, 'w') as f:
        json.dump(summary, f, indent=2)

    logger.info(f"Summary saved to {summary_path}")
    logger.info("Knowledge graph generation complete!")


if __name__ == "__main__":
    main()